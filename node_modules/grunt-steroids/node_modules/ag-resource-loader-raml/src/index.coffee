ramlSchema = require './raml/schema'
ramlSchemaToResource = require './raml/resource'
ramlSchemaToResourceBundle = require './raml/bundle'

module.exports =
  # (urlToRaml: String) -> { createResource: (name) -> Promise Resource }
  loadFile: (urlToRaml) ->
    loadSchema = do ->
      schema = null
      ->
        schema = ramlSchema.fromUrl urlToRaml unless schema?
        schema

    createResource: (name) ->
      loadSchema().then ramlSchemaToResource name

  # (pathToRaml: String) -> { toResourceBundle: () -> Promise Object }
  loadLocalFile: (pathToRaml) ->
    loadSchema = do ->
      schema = null
      ->
        schema = ramlSchema.fromFile pathToRaml unless schema?
        schema

    toResourceBundle: ->
      loadSchema().then ramlSchemaToResourceBundle

  # (ramlSchemaObject: Object) -> { createResource: (name) -> Resource }
  loadObject: (ramlSchemaObject) ->
    schema = ramlSchema.fromObject ramlSchemaObject
    createResource: (name) ->
      ramlSchemaToResource(name)(schema)
